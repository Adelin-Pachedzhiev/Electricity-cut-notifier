# Electricity Cut Notifier - GitHub Actions Edition

Автоматична система за известяване при планирани прекъсвания на електрозахранването от ЕРМ Запад.

## 🚀 Бърз старт за GitHub Actions

### 1. Създайте GitHub Repository

```bash
git init
git add .
git commit -m "Initial commit"
git branch -M main
git remote add origin https://github.com/YOUR_USERNAME/electricity-cut-notifier.git
git push -u origin main
```

### 2. Конфигурирайте GitHub Secrets

Отидете в **Settings → Secrets and variables → Actions** и добавете:

| Secret Name | Example Value | Description |
|-------------|---------------|-------------|
| `SENDER_EMAIL` | `biodix13@gmail.com` | Gmail адрес за изпращане |
| `SENDER_PASSWORD` | `xxxx xxxx xxxx xxxx` | Gmail App Password (16 символа) |
| `EMAIL_RECIPIENTS` | `email1@gmail.com,email2@abv.bg` | Получатели (разделени със запетая) |

**Важно за Gmail:** Използвайте App Password (не обикновената парола). Генерирайте на: https://myaccount.google.com/apppasswords

**Известия за грешки:** GitHub автоматично изпраща имейл при неуспешно изпълнение. Вижте [GITHUB_NOTIFICATIONS.md](GITHUB_NOTIFICATIONS.md).

### 3. Конфигурирайте градовете в config.json

```json
{
  "monitored_cities": ["ГЪРМЕН", "ДЕБРЕН", "САНДАНСКИ"],
  "check_days_ahead": 3,
  "smtp_server": "smtp.gmail.com",
  "smtp_port": 587
}
```

### 4. Готово!

Системата ще се стартира автоматично всеки ден в 10:00 ч. българско време.

## 📧 Формат на известието (на български)

```
От: <email>
До: вашия-имейл@example.com
Тема: Известие за прекъсване на тока - 2 дат(и) засегнат(и)

ПЛАНИРАНИ ПРЕКЪСВАНИЯ НА ТОКА - ИЗВЕСТИЕ
======================================================================

Дата: 17.11.2025
----------------------------------------------------------------------
Населено място: ГЪРМЕН
Област: БЛАГОЕВГРАД
Община: ГЪРМЕН
Време: 08:30 - 16:30

======================================================================
Източник: https://info.ermzapad.bg/webint/vok/avplan.php?PLAN=FYI
```

## 🔧 Конфигурация

### config.json

- `monitored_cities`: Списък с градове за проверка (кирилица, главни букви)
- `check_days_ahead`: Колко дни напред да проверява (по подразбиране: 3)
- `smtp_server`: SMTP сървър (Gmail: `smtp.gmail.com`)
- `smtp_port`: Порт (Gmail: 587)

### GitHub Secrets (задължителни - само 3!)

- `SENDER_EMAIL`: От кой имейл да изпраща
- `SENDER_PASSWORD`: Парола (за Gmail: App Password)
- `EMAIL_RECIPIENTS`: На кого да изпраща (разделени със запетая)

**Известия за грешки:** GitHub автоматично ви изпраща имейл при неуспешно изпълнение на workflow. Вижте [GITHUB_NOTIFICATIONS.md](GITHUB_NOTIFICATIONS.md) за настройка.

## ⏰ График на изпълнение

По подразбиране: Всеки ден в **10:00 ч. българско време** (8:00 UTC)

За промяна, редактирайте `.github/workflows/check-electricity-cuts.yml`:

```yaml
schedule:
  - cron: '0 8 * * *'  # 10:00 Bulgarian time
```

Примери:
- `0 7 * * *` = 09:00 българско време
- `0 9 * * *` = 11:00 българско време
- `0 6,18 * * *` = 08:00 и 20:00 българско време

## 🧪 Ръчно стартиране

1. Отидете в **Actions** таб
2. Изберете **Check Electricity Cuts**
3. Натиснете **Run workflow**
4. Проверете имейла си

## 📊 Как работи

```
┌─────────────────────────────────────────────────┐
│   GitHub Actions се стартира (ежедневно)        │
└─────────────┬───────────────────────────────────┘
              │
              ▼
┌─────────────────────────────────────────────────┐
│   Сваля PDF-и от info.ermzapad.bg               │
└─────────────┬───────────────────────────────────┘
              │
              ▼
┌─────────────────────────────────────────────────┐
│   Извлича информация за прекъсвания             │
└─────────────┬───────────────────────────────────┘
              │
              ▼
┌─────────────────────────────────────────────────┐
│   Филтрира по вашите градове                    │
└─────────────┬───────────────────────────────────┘
              │
         ┌────┴────┐
         │         │
    Намерени    Не са намерени
         │         │
         ▼         ▼
   ┌─────────┐   ┌──────────┐
   │ Изпраща │   │ Спира    │
   │ имейл   │   └──────────┘
   └─────────┘
```

## 🚨 Известия при грешки

Ако възникне грешка, администраторът получава имейл:

```
Тема: ГРЕШКА: Система за известия за прекъсвания на тока

Възникна грешка в системата за известия за прекъсвания на тока.

ГРЕШКА:
Connection timeout

ДЕТАЙЛИ:
[Пълна информация за грешката]

Време: 2025-11-15 10:30:45
```

## 💰 Цена

**Безплатно!** GitHub Actions предлага:
- Неограничени минути за публични repositories
- 2000 минути/месец за частни repositories
- Този workflow използва ~2-3 минути/ден = ~60-90 минути/месец

## 🔒 Сигурност

- ✅ Паролите се съхраняват като GitHub Secrets (криптирани)
- ✅ Никога не се показват в логовете
- ✅ Gmail App Password (не вашата главна парола)
- ✅ config.json НЕ съдържа пароли (само градове и настройки)

## 📝 Настройка на Gmail

### config.json

```json
{
  "smtp_server": "smtp.gmail.com",
  "smtp_port": 587
}
```

### GitHub Secrets

- `SENDER_EMAIL`: `<email>`
- `SENDER_PASSWORD`: App Password (16 символа, не обикновена парола!)

**Важно**: Трябва да използвате App Password, не обикновената Gmail парола.

Създаване на App Password: https://myaccount.google.com/apppasswords

## 🐛 Отстраняване на проблеми

### Workflow не работи

1. Проверете **Actions** таб за логове
2. Проверете GitHub Secrets са правилно зададени
3. Уверете се че `config.json` е качен в repository

### Не получавам имейл

1. Проверете SPAM папката
2. Проверете формата на `EMAIL_RECIPIENTS` (без интервали между имейлите)
3. Проверете workflow логовете за "Email sent successfully!"

### Грешка "Authentication failed"

- Трябва да използвате Gmail App Password (16 символа), не обикновена парола
- Проверете `SENDER_EMAIL` и `SENDER_PASSWORD` в GitHub Secrets
- Уверете се, че App Password е генериран правилно: https://myaccount.google.com/apppasswords

## 📚 Документация

- **[GITHUB_ACTIONS_SETUP.md](GITHUB_ACTIONS_SETUP.md)** - Детайлна стъпка-по-стъпка инструкция
- **[README.md](README.md)** - Оригинална документация
- **[QUICKSTART.md](QUICKSTART.md)** - Локално използване

## 🎯 Примерни градове

- ГЪРМЕН
- ДЕБРЕН
- САНДАНСКИ
- БЛАГОЕВГРАД
- СОФИЯ
- ПЕРНИК
- КЮСТЕНДИЛ
- ВРАЦА
- МОНТАНА
- ВИДИН

Използвайте точните имена както са изписани в PDF-ите (кирилица, главни букви).

## 📞 Поддръжка

При проблеми:
1. Проверете Actions логовете
2. Проверете имейла на администратор за грешки
3. Проверете дали website-а е достъпен: https://info.ermzapad.bg

## 📄 Лиценз

За лична/образователна употреба. Моля, спазвайте условията на ERMZapad website.
